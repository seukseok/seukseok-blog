---
interface Props {
  title: string;
  description?: string;
  canonical?: string;
  image?: string;
  type?: 'website' | 'article';
  jsonLd?: object;
}

const {
  title,
  description = '기술, 리뷰, 일상을 기록하는 seukseok의 개인 블로그',
  canonical,
  image = '/images/og-default.png',
  type = 'website',
  jsonLd,
} = Astro.props;

const url = new URL(Astro.url.pathname, Astro.site);
const canonicalURL = canonical ?? url.toString();
---

<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />
    <meta name="robots" content="index,follow,max-image-preview:large" />

    <meta property="og:type" content={type} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:image" content={new URL(image, Astro.site).toString()} />
    <meta name="twitter:card" content="summary_large_image" />

    {jsonLd && (
      <script type="application/ld+json" set:html={JSON.stringify(jsonLd)}></script>
    )}
  </head>
  <body>
    <header class="container">
      <a href="/" class="title">seukseok의 개인 블로그</a>
      <nav>
        <a href="/categories/tech">tech</a>
        <a href="/categories/review">review</a>
        <a href="/categories/log">log</a>
        <a href="/categories/pulse">pulse</a>
        <a href="/categories/jobs">jobs</a>
      </nav>
    </header>
    <main class="container">
      <slot />
    </main>
    <footer class="container footer">
      © {new Date().getFullYear()} seukseok.dev · 방문 <span id="site-visit-count">-</span>
    </footer>
    <script is:inline>
      (async () => {
        try {
          const key = `${location.hostname.replace(/\./g, '-')}:site-total`;
          const url = `https://api.countapi.xyz/hit/${encodeURIComponent(key)}/visits`;
          const res = await fetch(url, { method: 'GET' });
          const data = await res.json();
          const el = document.getElementById('site-visit-count');
          if (el && typeof data?.value === 'number') el.textContent = data.value.toLocaleString('ko-KR');
        } catch (_) {}
      })();
    </script>
  </body>
</html>

<style>
  :root { color-scheme: light; }
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: clamp(16px, 1.6vw, 18px);
    color: #111827;
    background: #fff;
    line-height: 1.7;
  }
  .container { max-width: 760px; margin: 0 auto; padding: 1rem 1.1rem; }
  header { display: flex; justify-content: space-between; align-items: center; gap: 1rem; flex-wrap: wrap; }
  .title { font-weight: 700; color: inherit; text-decoration: none; font-size: 1rem; }
  nav { display: flex; gap: 0.85rem; flex-wrap: wrap; }
  nav a { color: #2563eb; text-decoration: none; font-size: 0.95rem; }
  h1, h2, h3 { line-height: 1.35; }
  h1 { font-size: clamp(1.7rem, 4.8vw, 2.3rem); }
  p, li { word-break: keep-all; overflow-wrap: break-word; }
  a { color: #2563eb; }
  code { background: #f3f4f6; padding: 0.1rem 0.3rem; border-radius: 6px; }
  pre { padding: 1rem; overflow-x: auto; background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 10px; }
  img { max-width: 100%; height: auto; display: block; margin: 0.75rem 0; border-radius: 8px; }
  :global(article img) { width: 100%; max-width: 500px; height: auto; margin: 1rem auto; display: block; border-radius: 8px; }
  :global(article figure) { margin: 1rem 0; }
  :global(article figcaption) { color: #6b7280; font-size: 0.88rem; text-align: center; }
  @media (max-width: 640px) {
    :global(article img) { max-width: 100%; }
  }
  .footer { color: #6b7280; font-size: 0.9rem; }
</style>
